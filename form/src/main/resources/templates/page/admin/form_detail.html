<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{UI/layouts/admin/admin_layout}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì„¤ë¬¸ ìƒì„¸ - ìˆ˜í˜¸ëŒ€í–‰</title>
  <style>
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #f8f9fa;
    }
    
    .page-title {
      font-size: 28px;
      font-weight: bold;
      color: #333;
    }
    
    .header-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }
    
    .btn {
      padding: 10px 20px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn-primary {
      background-color: #007bff;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #0056b3;
    }
    
    .btn-success {
      background-color: #28a745;
      color: white;
    }
    
    .btn-success:hover {
      background-color: #218838;
    }
    
    .btn-warning {
      background-color: #ffc107;
      color: #212529;
    }
    
    .btn-warning:hover {
      background-color: #e0a800;
    }
    
    .detail-container {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 30px;
    }
    
    .detail-section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    
    .section-title {
      font-size: 20px;
      font-weight: bold;
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #007bff;
    }
    
    .detail-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .detail-item {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    
    .detail-item.full-width {
      grid-column: 1 / -1;
    }
    
    .detail-label {
      font-size: 14px;
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
    }
    
    .detail-value {
      font-size: 16px;
      color: #333;
      font-weight: 500;
    }
    
    .detail-value.large {
      font-size: 18px;
      font-weight: 600;
    }
    
    .status-info {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .status-badge {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 15px;
    }
    
    .status-pending {
      background-color: #fff3cd;
      color: #856404;
    }
    
    .status-approved {
      background-color: #d4edda;
      color: #155724;
    }
    
    .status-completed {
      background-color: #d1ecf1;
      color: #0c5460;
    }
    
    .status-cancelled {
      background-color: #f8d7da;
      color: #721c24;
    }
    
    .status-approved {
      background-color: #d4edda;
      color: #155724;
    }
    
    .status-completed {
      background-color: #d1ecf1;
      color: #0c5460;
    }
    
    .schedule-item {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      border-left: 4px solid #007bff;
    }
    
    .schedule-title {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }
    
    .schedule-date {
      font-size: 14px;
      color: #666;
      margin-bottom: 5px;
    }
    
    .schedule-note {
      font-size: 14px;
      color: #555;
    }
    
    .contact-card {
      background: linear-gradient(135deg, #e7f3ff 0%, #cce7ff 100%);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .contact-title {
      font-size: 16px;
      font-weight: 600;
      color: #007bff;
      margin-bottom: 10px;
    }
    
    .contact-info {
      font-size: 14px;
      color: #333;
      line-height: 1.6;
    }
    
    .sidebar {
      position: sticky;
      top: 20px;
    }
    
    .timeline {
      position: relative;
      padding-left: 30px;
    }
    
    .timeline::before {
      content: '';
      position: absolute;
      left: 15px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #dee2e6;
    }
    
    .timeline-item {
      position: relative;
      margin-bottom: 20px;
    }
    
    .timeline-item::before {
      content: '';
      position: absolute;
      left: -21px;
      top: 5px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #007bff;
      border: 3px solid white;
      box-shadow: 0 0 0 2px #dee2e6;
    }
    
    .timeline-content {
      background: white;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .timeline-title {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }
    
    .timeline-date {
      font-size: 12px;
      color: #666;
    }
    
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #666;
    }
    
    .empty-icon {
      font-size: 48px;
      margin-bottom: 15px;
      opacity: 0.5;
    }
    
    @media (max-width: 768px) {
      .detail-container {
        grid-template-columns: 1fr;
      }
      
      .detail-grid {
        grid-template-columns: 1fr;
      }
      
      .page-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 20px;
      }
      
      .header-actions {
        width: 100%;
        justify-content: flex-start;
      }
    }
  </style>
</head>
<body layout:fragment="content">
  <div class="container-fluid" th:if="${forms != null}">
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="page-header">
      <h2 class="page-title">ğŸ“‹ ì„¤ë¬¸ ìƒì„¸ ì •ë³´</h2>
      <div class="header-actions">
        <a href="/admin/forms" class="btn btn-primary">
          <i class="fas fa-arrow-left"></i> ëª©ë¡ìœ¼ë¡œ
        </a>
        <a th:href="@{/admin/forms/update/{id}(id=${forms.id})}" class="btn btn-warning">
          <i class="fas fa-edit"></i> ìˆ˜ì •
        </a>
        <button class="btn btn-success" onclick="approveForm()">
          <i class="fas fa-check"></i> ìŠ¹ì¸
        </button>
      </div>
    </div>
    
    <div class="detail-container">
      <!-- ë©”ì¸ ì½˜í…ì¸  -->
      <div class="main-content">
        <!-- ìƒíƒœ ì •ë³´ -->
        <div class="detail-section">
          <div class="status-info">
            <span class="status-badge" 
                  th:classappend="${forms.status == 'ìŠ¹ì¸' ? 'status-approved' : (forms.status == 'ì™„ë£Œ' ? 'status-completed' : (forms.status == 'ì·¨ì†Œ' ? 'status-cancelled' : 'status-pending'))}"
                  th:text="${forms.status != null ? forms.status : 'ê²€í†  ì¤‘'}">ê²€í†  ì¤‘</span>
            <div>ì ‘ìˆ˜ì¼ì‹œ: <span th:text="${#dates.format(forms.createdAt, 'yyyyë…„ MMì›” ddì¼ HH:mm')}">2024ë…„ 01ì›” 15ì¼ 14:30</span></div>
          </div>
        </div>
        
        <!-- ì‹ ì²­ì¸ ì •ë³´ -->
        <div class="detail-section">
          <h3 class="section-title">ğŸ‘¤ ì‹ ì²­ì¸ ì •ë³´</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">ì‹ ì²­ì¸ëª…</div>
              <div class="detail-value large" th:text="${forms.name}">í™ê¸¸ë™</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">ì—°ë½ì²˜</div>
              <div class="detail-value" th:text="${forms.tel}">010-1234-5678</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">ì…€í”„ ì§ì˜ ê³µì‚¬</div>
              <div class="detail-value">-</div>
            </div>
          </div>
          
          <!-- ì—…ì²´ ì •ë³´ -->
          <div th:if="${forms.bizName != null and forms.bizName != ''}">
            <div class="detail-grid">
              <div class="detail-item">
                <div class="detail-label">ì—…ì²´ëª…</div>
                <div class="detail-value" th:text="${forms.bizName}">ABC ì¸í…Œë¦¬ì–´</div>
              </div>
              <div class="detail-item" th:if="${forms.managerName != null and forms.managerName != ''}">
                <div class="detail-label">í˜„ì¥ ë‹´ë‹¹ì</div>
                <div class="detail-value" th:text="${forms.managerName}">ê¹€í˜„ì¥</div>
              </div>
              <div class="detail-item" th:if="${forms.managerTel != null and forms.managerTel != ''}">
                <div class="detail-label">ë‹´ë‹¹ì ì—°ë½ì²˜</div>
                <div class="detail-value" th:text="${forms.managerTel}">010-9876-5432</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ì£¼ì†Œ ì •ë³´ -->
        <div class="detail-section">
          <h3 class="section-title">ğŸ“ ì£¼ì†Œ ì •ë³´</h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <div class="detail-label">ì£¼ì†Œ</div>
              <div class="detail-value" th:text="${forms.address}">ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">ìƒì„¸ì£¼ì†Œ</div>
              <div class="detail-value" th:text="${forms.detailAddress}">101ë™ 101í˜¸</div>
            </div>
          </div>
        </div>
        
        <!-- ì„œë¹„ìŠ¤ ì •ë³´ -->
        <div class="detail-section">
          <h3 class="section-title">ğŸ› ï¸ ì„œë¹„ìŠ¤ ì •ë³´</h3>
          <div class="detail-grid">
            <div class="detail-item full-width" th:if="${forms.firstService != null and forms.firstService != '' and forms.firstService != 'null'}">
              <div class="detail-label">ì„œë¹„ìŠ¤1</div>
              <div class="detail-value">
                <span th:if="${forms.firstService != null and forms.firstService.contains('1')}">âœ“ ì…ì£¼ë¯¼ ë™ì˜ì„œ</span>
                <span th:if="${forms.firstService != null and forms.firstService.contains('1') and (forms.firstService.contains('2') or forms.firstService.contains('3'))}">, </span>
                <span th:if="${forms.firstService != null and forms.firstService.contains('2')}">âœ“ ìŠ¹ê°•ê¸° ê¸°íƒ€ ë³´ì–‘</span>
                <span th:if="${forms.firstService != null and forms.firstService.contains('2') and forms.firstService.contains('3')}">, </span>
                <span th:if="${forms.firstService != null and forms.firstService.contains('3')}">âœ“ í–‰ìœ„í—ˆê°€</span>
              </div>
            </div>
            <div class="detail-item" th:if="${forms.secondService != null and forms.secondService != '' and forms.secondService != 'null'}">
              <div class="detail-label">ì„œë¹„ìŠ¤2</div>
              <div class="detail-value" th:text="${forms.secondService == '1' ? 'âœ“ ë°©ì¶©ë§ ì‹œê³µ' : (forms.secondService == '2' ? 'âœ“ ì¢…í•© ì²­ì†Œ' : forms.secondService)}">âœ“ ë°©ì¶©ë§ ì‹œê³µ</div>
            </div>
          </div>
        </div>
        
        <!-- ê³µì‚¬ ê¸°ê°„ -->
        <div class="detail-section">
          <h3 class="section-title">ğŸ“… ê³µì‚¬ ê¸°ê°„</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">ê³µì‚¬ ì‹œì‘ì¼</div>
              <div class="detail-value" th:text="${#dates.format(forms.stdDate, 'yyyy-MM-dd')}">2024-01-15</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">ê³µì‚¬ ì¢…ë£Œì¼</div>
              <div class="detail-value" th:text="${#dates.format(forms.endDate, 'yyyy-MM-dd')}">2024-01-20</div>
            </div>
            <div class="detail-item" th:if="${forms.noiseDate != null and forms.noiseDate != ''}">
              <div class="detail-label">ì†ŒìŒ ë°œìƒì¼</div>
              <div class="detail-value" th:text="${forms.noiseDate}">2024-01-16, 2024-01-17</div>
            </div>
          </div>
        </div>
        
        <!-- ì…ì£¼ì ì •ë³´ -->
        <div class="detail-section" th:if="${forms.residentName != null and forms.residentName != ''}">
          <h3 class="section-title">ğŸ  ì…ì£¼ì ì •ë³´</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">ì…ì£¼ìëª…</div>
              <div class="detail-value" th:text="${forms.residentName}">ë°•ì…ì£¼</div>
            </div>
            <div class="detail-item" th:if="${forms.residentTel != null and forms.residentTel != ''}">
              <div class="detail-label">ì…ì£¼ì ì—°ë½ì²˜</div>
              <div class="detail-value" th:text="${forms.residentTel}">010-1111-2222</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">ì‹ ì²­ì¸ê³¼ ë™ì¼</div>
              <div class="detail-value" th:text="${forms.residentSame == 'Y' ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}">ì•„ë‹ˆì˜¤</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">ì¶”í›„ í†µë³´</div>
              <div class="detail-value" th:text="${forms.residentCheck == 'Y' ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}">ì•„ë‹ˆì˜¤</div>
            </div>
          </div>
        </div>
        
        <!-- ë™ì˜ì„œ ì¡°ê±´ (ì…ì£¼ë¯¼ ë™ì˜ì„œ) -->
        <div class="detail-section" th:if="${forms.agreementTerms != null and forms.agreementTerms != ''}">
          <h3 class="section-title">ğŸ“‹ ë™ì˜ì„œ ì¡°ê±´</h3>
          <div class="detail-grid">
            <div class="detail-item" th:if="${forms.agreementConditionCheck != null}">
              <div class="detail-label">ê´€ë¦¬ì‚¬ë¬´ì†Œ ì¡°ê±´ í™•ì¸</div>
              <div class="detail-value" th:text="${forms.agreementConditionCheck == 'Y' ? 'í™•ì¸ì™„ë£Œ' : 'ë¯¸í™•ì¸'}">í™•ì¸ì™„ë£Œ</div>
            </div>
            <div class="detail-item full-width">
              <div class="detail-label">ë™ì˜ì„œ ì¡°ê±´</div>
              <div class="detail-value" th:text="${forms.agreementTerms}">ë™ì˜ì„œ ì¡°ê±´ ë‚´ìš©</div>
            </div>
          </div>
        </div>
        
        <!-- ë³´ì–‘ ì •ë³´ (ìŠ¹ê°•ê¸° ë° ê¸°íƒ€ë³´ì–‘) -->
        <div class="detail-section" th:if="${forms.protectionTypes != null and forms.protectionTypes != ''}">
          <h3 class="section-title">ğŸ›¡ï¸ ë³´ì–‘ ì •ë³´</h3>
          <div class="detail-grid">
            <div class="detail-item full-width">
              <div class="detail-label">í•„ìš”í•œ ë³´ì–‘</div>
              <div class="detail-value" th:text="${forms.protectionTypes}">ì˜¬ë³´ì–‘, ì¤€ë³´ì–‘</div>
            </div>
            <div class="detail-item full-width" th:if="${forms.protectionDescription != null and forms.protectionDescription != ''}">
              <div class="detail-label">ë³´ì–‘ ì„¤ëª…</div>
              <div class="detail-value" th:text="${forms.protectionDescription}">ë³´ì–‘ ìƒì„¸ ì„¤ëª…</div>
            </div>
            <div class="detail-item" th:if="${forms.elevatorProtection != null}">
              <div class="detail-label">ìŠ¹ê°•ê¸° ì™¸ë¶€ ë³´ì–‘</div>
              <div class="detail-value" th:text="${forms.elevatorProtection == 'Y' ? 'ì˜ˆ' : (forms.elevatorProtection == 'A' ? 'ê´€ë¦¬ì‚¬ë¬´ì†Œ ì¡°ê±´ëŒ€ë¡œ ì§„í–‰í•´ì£¼ì„¸ìš”' : 'ì•„ë‹ˆì˜¤')}">ì˜ˆ</div>
            </div>
            <div class="detail-item" th:if="${forms.elevatorFloors != null and forms.elevatorFloors != ''}">
              <div class="detail-label">ì‹œê³µ ì¸µìˆ˜</div>
              <div class="detail-value" th:text="${forms.elevatorFloors}">15ì¸µ</div>
            </div>
            <div class="detail-item" th:if="${forms.entrancePassword != null and forms.entrancePassword != ''}">
              <div class="detail-label">í˜„ê´€ ë¹„ë°€ë²ˆí˜¸</div>
              <div class="detail-value" th:text="${forms.entrancePassword}">****</div>
            </div>
          </div>
        </div>
        
        <!-- í–‰ìœ„í—ˆê°€ ì •ë³´ -->
        <div class="detail-section" th:if="${forms.propertyStatus != null and forms.propertyStatus != ''}">
          <h3 class="section-title">ğŸ¢ í–‰ìœ„í—ˆê°€ ì •ë³´</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">ë§¤ë¬¼ ìƒíƒœ</div>
              <div class="detail-value" th:text="${forms.propertyStatus}">ì†Œìœ ì</div>
            </div>
            <div class="detail-item full-width" th:if="${forms.constructionScope != null and forms.constructionScope != ''}">
              <div class="detail-label">ê³µì‚¬ ë²”ìœ„</div>
              <div class="detail-value" th:text="${forms.constructionScope}">í™•ì¥, ë¹„ë‚´ë ¥ë²½ ì² ê±°ë°ì‹ ì„¤</div>
            </div>
            <div class="detail-item full-width" th:if="${forms.constructionScopeDescription != null and forms.constructionScopeDescription != ''}">
              <div class="detail-label">ê³µì‚¬ ë²”ìœ„ ìƒì„¸</div>
              <div class="detail-value" th:text="${forms.constructionScopeDescription}">ê³µì‚¬ ë²”ìœ„ ìƒì„¸ ì„¤ëª…</div>
            </div>
          </div>
        </div>
        
        <!-- ê³µì‚¬ ë‚´ìš© -->
        <div class="detail-section" th:if="${forms.content != null and forms.content != ''}">
          <h3 class="section-title">ğŸ“ ê³µì‚¬ ë‚´ìš©</h3>
          <div class="detail-item full-width">
            <div class="detail-value" th:text="${forms.content}">ë°”ë‹¥ì¬ êµì²´ ë° ë²½ì§€ ë„ë°° ì‘ì—…</div>
          </div>
        </div>
        
        <!-- ìš”ì²­ì‚¬í•­ -->
        <div class="detail-section" th:if="${forms.request != null and forms.request != ''}">
          <h3 class="section-title">ğŸ’¬ ìš”ì²­ì‚¬í•­</h3>
          <div class="detail-item full-width">
            <div class="detail-value" th:text="${forms.request}">ê¸°íƒ€ ìš”ì²­ì‚¬í•­ ë‚´ìš©</div>
          </div>
        </div>
      </div>
      
      <!-- ì‚¬ì´ë“œë°” -->
      <div class="sidebar">
        <!-- ì—°ë½ì²˜ ì •ë³´ -->
        <div class="detail-section">
          <div class="contact-card">
            <div class="contact-title">ğŸ“ ë¹ ë¥¸ ì—°ë½</div>
            <div class="contact-info">
              <strong>ì‹ ì²­ì¸:</strong> <span th:text="${forms.name}">í™ê¸¸ë™</span><br>
              <strong>ì—°ë½ì²˜:</strong> <span th:text="${forms.tel}">010-1234-5678</span><br>
            </div>
          </div>
          
          <div class="contact-card" th:if="${forms.managerName != null and forms.managerName != ''}">
            <div class="contact-title">ğŸ”§ í˜„ì¥ ë‹´ë‹¹ì</div>
            <div class="contact-info">
              <strong>ë‹´ë‹¹ì:</strong> <span th:text="${forms.managerName}">ê¹€í˜„ì¥</span><br>
              <strong>ì—°ë½ì²˜:</strong> <span th:text="${forms.managerTel}">010-9876-5432</span>
            </div>
          </div>
        </div>
        
        <!-- ê´€ë ¨ ì¼ì • -->
        <div class="detail-section">
          <h3 class="section-title">ğŸ“… ê´€ë ¨ ì¼ì •</h3>
          
          <div th:if="${schedules != null and !schedules.isEmpty()}">
            <div class="schedule-item" th:each="schedule : ${schedules}">
              <div class="schedule-title" th:text="${schedule.title}">ë°©ì¶©ë§ ì‹œê³µ - 101ë™ 101í˜¸</div>
              <div class="schedule-date" th:text="${#temporals.format(schedule.start, 'yyyy-MM-dd')} + ' ~ ' + ${#temporals.format(schedule.end, 'yyyy-MM-dd')}">2024-01-15 ~ 2024-01-20</div>
              <div class="schedule-note" th:if="${schedule.note != null and schedule.note != ''}" th:text="${schedule.note}">ìƒì„¸ ì¼ì • ë‚´ìš©</div>
            </div>
          </div>
          
          <div class="empty-state" th:if="${schedules == null or schedules.isEmpty()}">
            <div class="empty-icon">ğŸ“…</div>
            <p>ë“±ë¡ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤</p>
          </div>
        </div>
        
        <!-- ì²˜ë¦¬ ì´ë ¥ -->
        <div class="detail-section">
          <h3 class="section-title">ğŸ“‹ ì²˜ë¦¬ ì´ë ¥</h3>
          
          <div class="timeline">
            <div class="timeline-item">
              <div class="timeline-content">
                <div class="timeline-title">ì„¤ë¬¸ ì ‘ìˆ˜</div>
                <div class="timeline-date" th:text="${#dates.format(forms.createdAt, 'yyyy-MM-dd HH:mm')}">2024-01-15 14:30</div>
              </div>
            </div>
            
            <div class="timeline-item">
              <div class="timeline-content">
                <div class="timeline-title">ìë™ ì¼ì • ìƒì„±</div>
                <div class="timeline-date" th:text="${#dates.format(forms.createdAt, 'yyyy-MM-dd HH:mm')}">2024-01-15 14:31</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì„¤ë¬¸ì´ ì—†ëŠ” ê²½ìš° -->
  <div class="container-fluid" th:if="${forms == null}">
    <div class="empty-state">
      <div class="empty-icon">âŒ</div>
      <h3>ì„¤ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h3>
      <p>ìš”ì²­í•˜ì‹  ì„¤ë¬¸ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
      <a href="/admin/forms" class="btn btn-primary">ì„¤ë¬¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
  </div>

  <script th:src="@{/js/common/ajax.js}"></script>
  <script th:inline="javascript">
    /*<![CDATA[*/
    const formId = /*[[${forms?.id}]]*/ '';
    
    async function approveForm() {
      if (!formId) {
        $alert({
          title: 'âŒ ì˜¤ë¥˜',
          text: 'ì„¤ë¬¸ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
          icon: 'error'
        });
        return;
      }
      
      // ìŠ¹ì¸ í™•ì¸
      const result = await $confirm(
        'âœ… ì„¤ë¬¸ ìŠ¹ì¸',
        'ì´ ì„¤ë¬¸ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nìŠ¹ì¸ í›„ì—ëŠ” ìƒíƒœê°€ ë³€ê²½ë©ë‹ˆë‹¤.',
        'question',
        'ìŠ¹ì¸',
        'ì·¨ì†Œ'
      );
      
      const confirmed = result.isConfirmed;
      
      if (!confirmed) {
        return;
      }
      
      try {
        console.log('ğŸ“‹ ì„¤ë¬¸ ìŠ¹ì¸ ìš”ì²­:', formId);
        
        // API í˜¸ì¶œ
        const response = await formsAjax(`/${formId}/approve`, 'PUT');
        
        console.log('âœ… ìŠ¹ì¸ ì‘ë‹µ:', response);
        
        if (response.success) {
          await $alert({
            title: 'âœ… ìŠ¹ì¸ ì™„ë£Œ',
            text: response.message || 'ì„¤ë¬¸ì´ ì„±ê³µì ìœ¼ë¡œ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.',
            icon: 'success'
          });
          
          // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
          location.reload();
        } else {
          await $alert({
            title: 'âŒ ìŠ¹ì¸ ì‹¤íŒ¨',
            text: response.message || 'ì„¤ë¬¸ ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.',
            icon: 'error'
          });
        }
      } catch (error) {
        console.error('ìŠ¹ì¸ ì˜¤ë¥˜:', error);
        await $alert({
          title: 'âŒ ì„œë²„ ì˜¤ë¥˜',
          text: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
          icon: 'error'
        });
      }
    }
    /*]]>*/
  </script>
</body>
</html>